#!/bin/bash
set -e

command_string="latexmk"

case "$ACTION_FORMAT" in
    pdf)
        command_string="$command_string -pdf"
        ;;
    *)
        if [[ -f "latexmkrc" || -f ".latexmkrc" ]]; then
            echo "Configuration file detected"
        else
            echo "Invalid input for action argument: format (must be pdf)"
            exit 1
        fi
        ;;
esac

if [ -n "$ACTION_FILENAME" ]; then
    command_string="$command_string $ACTION_FILENAME"
fi

echo "Command: $command_string"
eval "$command_string"
